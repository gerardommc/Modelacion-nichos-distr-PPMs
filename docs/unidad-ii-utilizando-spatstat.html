<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 4 Unidad II - Utilizando spatstat | Modelación de nichos ecológicos y aŕeas de distribución con MPPs</title>
  <meta name="description" content="Sitio del curso de Modelado de nichos ecológicos | Posgrado de Ciencias Biológicas" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content=" 4 Unidad II - Utilizando spatstat | Modelación de nichos ecológicos y aŕeas de distribución con MPPs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Sitio del curso de Modelado de nichos ecológicos | Posgrado de Ciencias Biológicas" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 4 Unidad II - Utilizando spatstat | Modelación de nichos ecológicos y aŕeas de distribución con MPPs" />
  
  <meta name="twitter:description" content="Sitio del curso de Modelado de nichos ecológicos | Posgrado de Ciencias Biológicas" />
  

<meta name="author" content="Gerardo Martín" />


<meta name="date" content="2022-04-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelación de nichos ecológicos y distribuciones con MPPs I</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preámbulo</a></li>
<li class="chapter" data-level="2" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html"><i class="fa fa-check"></i><b>2</b> Encuadre de la materia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html#criterios-de-evaluación"><i class="fa fa-check"></i><b>2.1</b> Criterios de evaluación</a></li>
<li class="chapter" data-level="2.2" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html#cómo-se-darán-las-clases"><i class="fa fa-check"></i><b>2.2</b> ¿Cómo se darán las clases?</a></li>
<li class="chapter" data-level="2.3" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html#contacto"><i class="fa fa-check"></i><b>2.3</b> Contacto</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><i class="fa fa-check"></i><b>3</b> Unidad I: Introducción al modelado de procesos de puntos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html#introducción"><i class="fa fa-check"></i><b>3.1</b> Introducción</a></li>
<li class="chapter" data-level="3.2" data-path="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html#formateo-de-datos"><i class="fa fa-check"></i><b>3.2</b> Formateo de datos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html#formateo-de-datos-raster"><i class="fa fa-check"></i><b>3.2.1</b> Formateo de datos raster</a></li>
<li class="chapter" data-level="3.2.2" data-path="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html#obteniendo-la-ventana-de-trabajo"><i class="fa fa-check"></i><b>3.2.2</b> Obteniendo la ventana de trabajo</a></li>
<li class="chapter" data-level="3.2.3" data-path="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html"><a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html#formateando-los-registros-de-ocurrencia"><i class="fa fa-check"></i><b>3.2.3</b> Formateando los registros de ocurrencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="unidad-ii-utilizando-spatstat.html"><a href="unidad-ii-utilizando-spatstat.html"><i class="fa fa-check"></i><b>4</b> Unidad II - Utilizando <code>spatstat</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="unidad-ii-utilizando-spatstat.html"><a href="unidad-ii-utilizando-spatstat.html#análisis-exploratorio"><i class="fa fa-check"></i><b>4.1</b> Análisis exploratorio</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="unidad-ii-utilizando-spatstat.html"><a href="unidad-ii-utilizando-spatstat.html#independencia-y-autocorrelación"><i class="fa fa-check"></i><b>4.1.1</b> Independencia y autocorrelación</a></li>
<li class="chapter" data-level="4.1.2" data-path="unidad-ii-utilizando-spatstat.html"><a href="unidad-ii-utilizando-spatstat.html#análisis-gráfico-de-las-respuestas-al-medio-ambiente."><i class="fa fa-check"></i><b>4.1.2</b> Análisis gráfico de las respuestas al medio ambiente.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://gerardommc.github.io" target="blank">Regresar al labo</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelación de nichos ecológicos y aŕeas de distribución con MPPs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unidad-ii---utilizando-spatstat" class="section level1" number="4">
<h1><span class="header-section-number"> 4</span> Unidad II - Utilizando <code>spatstat</code></h1>
<div id="análisis-exploratorio" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Análisis exploratorio</h2>
<p>Antes de proponer un modelo para los datos de ocurrencia, es buena práctica realizar un análisis exploratorio. En realidad, el modelo que propongamos dependerá en buena medida de este análisis exploratorio. Los análisis exploratorios que yo hago comprenden una serie de pasos:</p>
<ol style="list-style-type: decimal">
<li>Probar si los datos de ocurrencia cumplen son independientes unos de otros o si están autocorrelacionados</li>
<li>Ver la respuesta de la intensidad de puntos ante las diferentes variables ambientales que queremos incorporar en el modelo</li>
<li>Medir la correlación entre las diferentes variables</li>
<li>Con base en los puntos 2 y 3 proponer un conjunto de modelos alternativos (más sobre este punto abajo)</li>
</ol>
<div id="independencia-y-autocorrelación" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Independencia y autocorrelación</h3>
<p>Se dice que los diferentes puntos son independientes entre sí, si el número de vecinos promedio de cada punto como función de la distancia, sigue una distribución Poisson (figura <a href="unidad-ii-utilizando-spatstat.html#fig:Cuenta-vecinos">4.1</a>). Con esto en mente hay varios escenarios posibles, que en promedio cada punto tenga más vecinos de lo esperado o que tenga menos. En el primer caso, se dice que los puntos están agregados, pues un punto tiende a atraer a otros. En el segundo, los puntos están segregados, o sea que un punto tiende a mantener a otros puntos lejos de sí. El primer caso, de independencia, suele ocurrir cuando los puntos están distribuidos aleatoriamente (figura <a href="unidad-ii-utilizando-spatstat.html#fig:Segreg-agreg">4.2</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:Cuenta-vecinos"></span>
<img src="Unidad-II/Cuenta-vecinos.png" alt="Número de vecinos como función de la distancia en un proceso de puntos." width="412" />
<p class="caption">
Figura 4.1: Número de vecinos como función de la distancia en un proceso de puntos.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:Segreg-agreg"></span>
<img src="Unidad-II/Ejemplo-procesos.png" alt="Ejemplo de procesos de puntos de izquierda a derecha: segregado, aleatorio y agregado (reproducido de Baddeley y Rubak 2016)" width="1069" />
<p class="caption">
Figura 4.2: Ejemplo de procesos de puntos de izquierda a derecha: segregado, aleatorio y agregado (reproducido de Baddeley y Rubak 2016)
</p>
</div>
<p>Existe una serie de pruebas gráficas y estadísticas para medir autocorrelación. Aquí nos enfocaremos en el uso de la prueba de envolturas <em>K</em> de Ripley. La implementación de esta prueba en <code>spatstat</code> genera unos intervalos de confianza alrededor de la expectativa del número de vecinos por medio de simulación. La figura <a href="unidad-ii-utilizando-spatstat.html#fig:K-env">4.3</a> muestra los tres escenarios de segregación, aleatorio y agrecación.</p>
<div class="figure" style="text-align: center"><span id="fig:K-env"></span>
<img src="Unidad-II/K-Ripley.png" alt="Gráfica de la prueba *K* de Ripley implementada en `spatstat`. De izquierda a derecha: funciones de Ripley para puntos segregados, aleatorios y agregados." width="870" />
<p class="caption">
Figura 4.3: Gráfica de la prueba <em>K</em> de Ripley implementada en <code>spatstat</code>. De izquierda a derecha: funciones de Ripley para puntos segregados, aleatorios y agregados.
</p>
</div>
<div id="análisis-de-autocorrelación-en-r-con-spatstat" class="section level4" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Análisis de autocorrelación en <strong>R</strong> con <code>spatstat</code></h4>
<p>Haremos este análisis de autocorrelación con el mismo proceso de puntos que formateamos anteriormente. La función de <code>spatstat</code> para la prueba de Ripley es <code>envelope</code>, y los argumentos que requiere son 1) el proceso de puntos a analizar, 2) la función con que se medirá autocorrelación (<code>Kest</code> para <span class="math inline">\(K\)</span> de Ripley) y 3) el número de simulaciones. Normalmente, para un nivel de significancia <span class="math inline">\(P=0.05\)</span>, se utilizan 39 simulaciones, el cual deberá aumentar si el umbral de significancia buscado es más estricto (<span class="math inline">\(P = 0.01\)</span>, p. ej.).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="unidad-ii-utilizando-spatstat.html#cb18-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">envelope</span>(puntos.ppp, <span class="at">fun =</span> Kest, <span class="at">nsim =</span> <span class="dv">39</span>)</span></code></pre></div>
<pre><code>## Generating 39 simulations of CSR  ...
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,  39.
## 
## Done.</code></pre>
<p>Mientras la función corre, <strong>R</strong> imprime la última simulación completada, y el objeto que se obtiene puede graficarse con el método por defecto <code>plot</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="unidad-ii-utilizando-spatstat.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-19"></span>
<img src="Mod-nich-distr-MPPs_files/figure-html/unnamed-chunk-19-1.png" alt="Gráfica de la función *K* de Ripley para el proceso de puntos analizado. Las sombras en gris muestran los intervalos de confianza al 95%. La línea roja a guiones representa la expectativa teórica (*K* teórica) en caso de que el proceso de puntos sea aleatorio, y la línea negra sólida es la función de Ripley para el proceso de puntos (la *K* observada). El eje de las *x* representa distancia (en grados) y las *y* el número promedio de vecinos de cada punto." width="576" />
<p class="caption">
Figura 4.4: Gráfica de la función <em>K</em> de Ripley para el proceso de puntos analizado. Las sombras en gris muestran los intervalos de confianza al 95%. La línea roja a guiones representa la expectativa teórica (<em>K</em> teórica) en caso de que el proceso de puntos sea aleatorio, y la línea negra sólida es la función de Ripley para el proceso de puntos (la <em>K</em> observada). El eje de las <em>x</em> representa distancia (en grados) y las <em>y</em> el número promedio de vecinos de cada punto.
</p>
</div>
</div>
</div>
<div id="análisis-gráfico-de-las-respuestas-al-medio-ambiente." class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Análisis gráfico de las respuestas al medio ambiente.</h3>
<p>Para este análisis simularé una base de datos de ocurrencia donde la probabilidad de observarlos sea inversamente proporcional a la distancia de una centroide pre definido. Con base en ello, podremos ver cómo cambia la intensidad de puntos en realción a los diferentes valores de cada variable.</p>
<div id="simulación-de-datos-de-presencia" class="section level4" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Simulación de datos de presencia</h4>
<p>Utilizaré las mismas variables que para el ejercicio anterior de formateo, y el centroide estará localizado en la media aritmética de cada capa:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="unidad-ii-utilizando-spatstat.html#cb21-1" aria-hidden="true" tabindex="-1"></a>centroide <span class="ot">&lt;-</span> <span class="fu">cellStats</span>(s, mean)</span></code></pre></div>
<p>Para calcular la distancia al centroide, necesitamos la covarianza entre las diferentes capas, de modo que la calculamos con la función <code>cov</code>. Hay implementaciones más robustas en el paquete <code>MASS</code>, para nuestros propósitos pedagógicos <code>cov</code> es suficiente. Comenzamos entonces, transformando el stack en una tabla:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="unidad-ii-utilizando-spatstat.html#cb22-1" aria-hidden="true" tabindex="-1"></a>s.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rasterToPoints</span>(s))</span>
<span id="cb22-2"><a href="unidad-ii-utilizando-spatstat.html#cb22-2" aria-hidden="true" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">cov</span>(s.df[, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<p>Posteriormente, utilizando el centroide y la matriz de covarianza, generamos las distancias utilizando las tres columnas del objeto <code>s.df</code> que contienen los valores de las variables ambientales:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="unidad-ii-utilizando-spatstat.html#cb23-1" aria-hidden="true" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(s.df[, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">center =</span> centroide, <span class="at">cov =</span> covar)</span></code></pre></div>
<p>Y transformamos las distancias al centroide en una capa raster:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="unidad-ii-utilizando-spatstat.html#cb24-1" aria-hidden="true" tabindex="-1"></a>md.r <span class="ot">&lt;-</span> <span class="fu">rasterFromXYZ</span>(<span class="fu">data.frame</span>(s.df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], md))</span>
<span id="cb24-2"><a href="unidad-ii-utilizando-spatstat.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md.r)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Distancia"></span>
<img src="Mod-nich-distr-MPPs_files/figure-html/Distancia-1.png" alt="Distancia Mahalanobis al centroide de las capas." width="480" />
<p class="caption">
Figura 4.5: Distancia Mahalanobis al centroide de las capas.
</p>
</div>
<p>Para simular las ocurrencias, transformaré la capa de distancias exponencialmente, para obtener una superficie probabilística:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="unidad-ii-utilizando-spatstat.html#cb25-1" aria-hidden="true" tabindex="-1"></a>md.exp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>md.r)</span>
<span id="cb25-2"><a href="unidad-ii-utilizando-spatstat.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md.exp)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Favorabilidad"></span>
<img src="Mod-nich-distr-MPPs_files/figure-html/Favorabilidad-1.png" alt="Distancia Mahalanobis transformada exponencialmente para simular presencias. Verde indica mayor probabilidad de ocurrencia." width="480" />
<p class="caption">
Figura 4.6: Distancia Mahalanobis transformada exponencialmente para simular presencias. Verde indica mayor probabilidad de ocurrencia.
</p>
</div>
<p>Para simular las presencias usaré el mismo método que anteriormente, pero en esta ocasión la probabilidad determinará las celdas en que habrá puntos:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="unidad-ii-utilizando-spatstat.html#cb26-1" aria-hidden="true" tabindex="-1"></a>puntos<span class="fl">.2</span> <span class="ot">&lt;-</span> dismo<span class="sc">::</span><span class="fu">randomPoints</span>(<span class="at">mask =</span> md.exp,</span>
<span id="cb26-2"><a href="unidad-ii-utilizando-spatstat.html#cb26-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">n =</span> <span class="dv">200</span>,</span>
<span id="cb26-3"><a href="unidad-ii-utilizando-spatstat.html#cb26-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prob =</span> T)</span></code></pre></div>
<pre><code>## Warning in if (class(cells) == &quot;try-error&quot;) {: la condición tiene longitud &gt; 1
## y sólo el primer elemento será usado</code></pre>
<pre><code>## Warning in .couldBeLonLat(x, warnings = warnings): CRS is NA. Assuming it is
## longitude/latitude</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="unidad-ii-utilizando-spatstat.html#cb29-1" aria-hidden="true" tabindex="-1"></a>puntos<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(puntos<span class="fl">.2</span>)</span>
<span id="cb29-2"><a href="unidad-ii-utilizando-spatstat.html#cb29-2" aria-hidden="true" tabindex="-1"></a>puntos<span class="fl">.2</span><span class="sc">$</span>x <span class="ot">&lt;-</span> puntos<span class="fl">.2</span><span class="sc">$</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)</span>
<span id="cb29-3"><a href="unidad-ii-utilizando-spatstat.html#cb29-3" aria-hidden="true" tabindex="-1"></a>puntos<span class="fl">.2</span><span class="sc">$</span>y <span class="ot">&lt;-</span> puntos<span class="fl">.2</span><span class="sc">$</span>y <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)</span>
<span id="cb29-4"><a href="unidad-ii-utilizando-spatstat.html#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="unidad-ii-utilizando-spatstat.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md.exp); <span class="fu">points</span>(puntos<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="Mod-nich-distr-MPPs_files/figure-html/unnamed-chunk-23-1.png" width="672" />
#### Graficación y análisis de las respuestas</p>
<p>Para continuar con el análisis, necesitamos formatear el objeto <code>puntos.2</code> como <code>ppp</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="unidad-ii-utilizando-spatstat.html#cb30-1" aria-hidden="true" tabindex="-1"></a>puntos.<span class="fl">2.</span>ppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> puntos<span class="fl">.2</span><span class="sc">$</span>x,</span>
<span id="cb30-2"><a href="unidad-ii-utilizando-spatstat.html#cb30-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> puntos<span class="fl">.2</span><span class="sc">$</span>y,</span>
<span id="cb30-3"><a href="unidad-ii-utilizando-spatstat.html#cb30-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">window =</span> win,</span>
<span id="cb30-4"><a href="unidad-ii-utilizando-spatstat.html#cb30-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">check =</span> F)</span></code></pre></div>
<p>Recordemos que el objeto <code>win</code> lo generamos en la sección de formateo de este tutorial. Para el análisis de las respuestas necesitamos crear otro objeto, que contiene los conteos de cuadratura, es decir, cuántas presencias por unidad espacial, con la función <code>pixelquad</code> que requiere de dos argumentos, el proceso planar de puntos y la ventana de trabajo en formato <code>owin</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="unidad-ii-utilizando-spatstat.html#cb31-1" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">pixelquad</span>(<span class="at">X =</span> puntos.<span class="fl">2.</span>ppp, <span class="at">W =</span> <span class="fu">as.owin</span>(win))</span></code></pre></div>
<p>Dado que las capas ya están también formateadas como <code>im</code>, podemos ahora sí continuar con el análisis de las respuestas con la función <code>plotQuantIntens</code>. Esta función generará unos gráficos en pdf que deberemos revisar después de correrla. Para cargar la función, haremos igual que con las anteriores. Puedes descargar la función <a href="Funciones-spatstat/plotQuantIntens.R">aquí</a>. Esta función requiere de varios argumentos:</p>
<ol style="list-style-type: decimal">
<li>La lista de imágenes que se usarán para ver cómo cambia la intensidad de puntos en relación a cada variable</li>
<li>El número de cuantiles en que se cortará cada variable para representar la intensidad en el espacio</li>
<li>El objeto de cuadratura (<code>Q</code>)</li>
<li>El objeto con los puntos en formato <code>ppp</code></li>
<li>El nombre del directorio donde se guardará el archivo pdf</li>
<li>El nombre del archivo</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="unidad-ii-utilizando-spatstat.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;../Funciones-spatstat/plotQuantIntens.R&quot;</span>)</span>
<span id="cb32-2"><a href="unidad-ii-utilizando-spatstat.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="unidad-ii-utilizando-spatstat.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotQuantIntens</span>(<span class="at">imList =</span> s.im,</span>
<span id="cb32-4"><a href="unidad-ii-utilizando-spatstat.html#cb32-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">noCuts =</span> <span class="dv">5</span>,</span>
<span id="cb32-5"><a href="unidad-ii-utilizando-spatstat.html#cb32-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">Quad =</span> Q,</span>
<span id="cb32-6"><a href="unidad-ii-utilizando-spatstat.html#cb32-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.pp =</span> puntos.<span class="fl">2.</span>ppp,</span>
<span id="cb32-7"><a href="unidad-ii-utilizando-spatstat.html#cb32-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">dir =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb32-8"><a href="unidad-ii-utilizando-spatstat.html#cb32-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">name =</span> <span class="st">&quot;Responses-centroid.pdf&quot;</span>)</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<p>El <a href="Unidad-II/Responses-centroid.pdf">archivo de gráficas</a> que produce <code>plotQuantIntens</code> muestra en cada panel:</p>
<ol style="list-style-type: decimal">
<li><p>La variable analizada con el número de puntos en cada región de varlores especificada por el argumento <code>noCuts</code> o nombre de cortes</p></li>
<li><p>La variable analizada y el proceso de puntos</p></li>
<li><p>La respuesta de la intensidad de puntos a la variable analizada. En el eje de las <span class="math inline">\(x\)</span> (horizontal), el valor de la variable, y en el eje de las <span class="math inline">\(y\)</span> la intensidad de puntos.</p></li>
</ol>
<p>La idea de este análisis es que podamos identificar a priori qué variables podemos incluir en el modelo y con qué tipo de relación. Por ejemplo, las variables 2 y 3 tienen respuestas claramente de una parácola invertida o de campana, por lo que podemos utilizar una fórmula polinomial de <span class="math inline">\(2^o\)</span> grado (figura <a href="unidad-ii-utilizando-spatstat.html#fig:Cuadratica">4.7</a>). Para la variable 1, no hay una respuesta clara como con las variables 2 y 3. Sin embargo, dado que la intensidad de puntos tiende a aumentar después de disminuir alrededor del valor de 190 conforme la variable aumenta podríamos utilizar un término cúbico, pues una ecuación cúbica puede adquirir esta forma (figura <a href="unidad-ii-utilizando-spatstat.html#fig:Cubica">4.8</a>).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="unidad-ii-utilizando-spatstat.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>), <span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Cuadratica"></span>
<img src="Mod-nich-distr-MPPs_files/figure-html/Cuadratica-1.png" alt="Ecuación polinomial de 2o grado exponenciada." width="480" />
<p class="caption">
Figura 4.7: Ecuación polinomial de 2o grado exponenciada.
</p>
</div>
<p>Por otro lado, una ecuación polinomial de <span class="math inline">\(3^{er}\)</span> grado:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="unidad-ii-utilizando-spatstat.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">+</span> x <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">3</span>), <span class="at">from =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">to =</span> <span class="fl">1.4</span> )</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Cubica"></span>
<img src="Mod-nich-distr-MPPs_files/figure-html/Cubica-1.png" alt="Ecuación polinomial de 3er grado exponenciada." width="480" />
<p class="caption">
Figura 4.8: Ecuación polinomial de 3er grado exponenciada.
</p>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="unidad-i-introducción-al-modelado-de-procesos-de-puntos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Mod-nich-distr-MPPs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
