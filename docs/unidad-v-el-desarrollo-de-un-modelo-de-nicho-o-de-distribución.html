<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 7 Unidad V: El desarrollo de un modelo de nicho o de distribuci√≥n | Modelaci√≥n de nichos ecol√≥gicos y a≈ïeas de distribuci√≥n con MPPs</title>
  <meta name="description" content="Sitio del curso de Modelado de nichos ecol√≥gicos | Posgrado de Ciencias Biol√≥gicas" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content=" 7 Unidad V: El desarrollo de un modelo de nicho o de distribuci√≥n | Modelaci√≥n de nichos ecol√≥gicos y a≈ïeas de distribuci√≥n con MPPs" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Sitio del curso de Modelado de nichos ecol√≥gicos | Posgrado de Ciencias Biol√≥gicas" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 7 Unidad V: El desarrollo de un modelo de nicho o de distribuci√≥n | Modelaci√≥n de nichos ecol√≥gicos y a≈ïeas de distribuci√≥n con MPPs" />
  
  <meta name="twitter:description" content="Sitio del curso de Modelado de nichos ecol√≥gicos | Posgrado de Ciencias Biol√≥gicas" />
  

<meta name="author" content="Gerardo Mart√≠n" />


<meta name="date" content="2022-11-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelaci√≥n de nichos ecol√≥gicos y distribuciones con MPPs I</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Pre√°mbulo</a></li>
<li class="chapter" data-level="2" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html"><i class="fa fa-check"></i><b>2</b> Encuadre de la materia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html#criterios-de-evaluaci√≥n"><i class="fa fa-check"></i><b>2.1</b> Criterios de evaluaci√≥n</a></li>
<li class="chapter" data-level="2.2" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html#c√≥mo-se-dar√°n-las-clases"><i class="fa fa-check"></i><b>2.2</b> ¬øC√≥mo se dar√°n las clases?</a></li>
<li class="chapter" data-level="2.3" data-path="encuadre-de-la-materia.html"><a href="encuadre-de-la-materia.html#contacto"><i class="fa fa-check"></i><b>2.3</b> Contacto</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><i class="fa fa-check"></i><b>3</b> Unidad I: Introducci√≥n al modelado de nichos ecol√≥gicos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#introducci√≥n-al-modelado-de-nichos-ecol√≥gicos"><i class="fa fa-check"></i><b>3.1</b> Introducci√≥n al modelado de nichos ecol√≥gicos</a></li>
<li class="chapter" data-level="3.2" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#insumos-para-el-modelado-correlativo-de-nichos-ecol√≥gicos"><i class="fa fa-check"></i><b>3.2</b> Insumos para el modelado correlativo de nichos ecol√≥gicos</a></li>
<li class="chapter" data-level="3.3" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#el-proceso-de-calibraci√≥n"><i class="fa fa-check"></i><b>3.3</b> El proceso de calibraci√≥n</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#tutorial-de-r"><i class="fa fa-check"></i><b>3.3.1</b> Tutorial de <strong>R</strong></a></li>
<li class="chapter" data-level="3.3.2" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#calibraci√≥n-de-modelos-de-nicho-ecol√≥gico"><i class="fa fa-check"></i><b>3.3.2</b> Calibraci√≥n de modelos de nicho ecol√≥gico</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#uso-de-r-como-sistema-de-informaci√≥n-geogr√°fica"><i class="fa fa-check"></i><b>3.4</b> Uso de R como Sistema de Informaci√≥n Geogr√°fica</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html"><a href="unidad-i-introducci√≥n-al-modelado-de-nichos-ecol√≥gicos.html#lectura-de-capas-raster"><i class="fa fa-check"></i><b>3.4.1</b> Lectura de capas raster</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><a href="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><i class="fa fa-check"></i><b>4</b> Unidad II: Modelaci√≥n de nichos ecol√≥gicos con procesos de puntos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><a href="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html#introducci√≥n"><i class="fa fa-check"></i><b>4.1</b> Introducci√≥n</a></li>
<li class="chapter" data-level="4.2" data-path="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><a href="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html#formateo-de-datos"><i class="fa fa-check"></i><b>4.2</b> Formateo de datos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><a href="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html#formateo-de-datos-raster"><i class="fa fa-check"></i><b>4.2.1</b> Formateo de datos raster</a></li>
<li class="chapter" data-level="4.2.2" data-path="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><a href="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html#obteniendo-la-ventana-de-trabajo"><i class="fa fa-check"></i><b>4.2.2</b> Obteniendo la ventana de trabajo</a></li>
<li class="chapter" data-level="4.2.3" data-path="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html"><a href="unidad-ii-modelaci√≥n-de-nichos-ecol√≥gicos-con-procesos-de-puntos.html#formateando-los-registros-de-ocurrencia"><i class="fa fa-check"></i><b>4.2.3</b> Formateando los registros de ocurrencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html"><i class="fa fa-check"></i><b>5</b> Unidad II - Utilizando <code>spatstat</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#an√°lisis-exploratorio"><i class="fa fa-check"></i><b>5.1</b> An√°lisis exploratorio</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#independencia-y-autocorrelaci√≥n"><i class="fa fa-check"></i><b>5.1.1</b> Independencia y autocorrelaci√≥n</a></li>
<li class="chapter" data-level="5.1.2" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#an√°lisis-gr√°fico-de-las-respuestas-al-medio-ambiente."><i class="fa fa-check"></i><b>5.1.2</b> An√°lisis gr√°fico de las respuestas al medio ambiente.</a></li>
<li class="chapter" data-level="5.1.3" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#midiendo-la-correlaci√≥n-entre-variables-independientes"><i class="fa fa-check"></i><b>5.1.3</b> Midiendo la correlaci√≥n entre variables independientes</a></li>
<li class="chapter" data-level="5.1.4" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#propuesta-de-modelos-alternativos"><i class="fa fa-check"></i><b>5.1.4</b> Propuesta de modelos alternativos</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#ajustando-un-proceso-de-puntos"><i class="fa fa-check"></i><b>5.2</b> Ajustando un proceso de puntos</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#selecci√≥n-del-modelo"><i class="fa fa-check"></i><b>5.2.1</b> Selecci√≥n del modelo</a></li>
<li class="chapter" data-level="5.2.2" data-path="unidad-ii---utilizando-spatstat.html"><a href="unidad-ii---utilizando-spatstat.html#verificaci√≥n-de-supuestos-de-independencia"><i class="fa fa-check"></i><b>5.2.2</b> Verificaci√≥n de supuestos de independencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html"><a href="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html"><i class="fa fa-check"></i><b>6</b> Unidad IV: Modelos para procesos de puntos con estructura espacial</a>
<ul>
<li class="chapter" data-level="6.1" data-path="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html"><a href="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html#tipos-de-estructura-espacial"><i class="fa fa-check"></i><b>6.1</b> Tipos de estructura espacial</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html"><a href="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html#modelos-de-interacci√≥n-de-puntos"><i class="fa fa-check"></i><b>6.1.1</b> Modelos de interacci√≥n de puntos</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html"><a href="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html#modelos-para-los-diferentes-tipos-de-estructura"><i class="fa fa-check"></i><b>6.2</b> Modelos para los diferentes tipos de estructura</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><i class="fa fa-check"></i><b>7</b> Unidad V: El desarrollo de un modelo de nicho o de distribuci√≥n</a>
<ul>
<li class="chapter" data-level="7.1" data-path="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#selecci√≥n-de-proyecci√≥n-geogr√°fica"><i class="fa fa-check"></i><b>7.1</b> Selecci√≥n de proyecci√≥n geogr√°fica</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#transformando-los-sistemas-de-coordenadas-en-r"><i class="fa fa-check"></i><b>7.1.1</b> Transformando los sistemas de coordenadas en R</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#selecci√≥n-de-variables-ambientales"><i class="fa fa-check"></i><b>7.2</b> Selecci√≥n de variables ambientales</a></li>
<li class="chapter" data-level="7.3" data-path="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#validaci√≥n-del-modelo"><i class="fa fa-check"></i><b>7.3</b> Validaci√≥n del modelo</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#pruebas-de-validaci√≥n-estad√≠stica"><i class="fa fa-check"></i><b>7.3.1</b> Pruebas de validaci√≥n estad√≠stica</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://gerardommc.github.io" target="blank">Regresar al labo</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelaci√≥n de nichos ecol√≥gicos y a≈ïeas de distribuci√≥n con MPPs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number"> 7</span> Unidad V: El desarrollo de un modelo de nicho o de distribuci√≥n<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="selecci√≥n-de-proyecci√≥n-geogr√°fica" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Selecci√≥n de proyecci√≥n geogr√°fica<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#selecci√≥n-de-proyecci√≥n-geogr√°fica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La tierra es un elipsoide, y uno de los retos geom√©tricos m√°s grandes es la representaci√≥n de su superficie como un plano. Para entender la complejidad del problema, pensemos en la tierra como una pelota de playa que cortamos y tratamos de extender sobre una mesa. En este proceso nos damos cuenta de que obtenemos algunas porciones del material bien extendidas y otras con arrugas. Esto mismo sucede cuando intentamos representar la tierra como una superficie plana. Para solucionar este problema se han propuesto varias soluciones, proyectando la superficie terrestre en diferentes formas geom√©tricas como:</p>
<ol style="list-style-type: decimal">
<li>Plano tangente a alg√∫n punto espec√≠fico</li>
<li>Cono que toca la superficie terrestre en alg√∫n paralelo</li>
<li>Cilindro que toca la superficie en el ecuador</li>
</ol>
<p>Todas estas metodolog√≠as resultan en distorsiones diferentes, como de √°reas o √°ngulos. Es imposible representar correctamente todos estos aspectos, de modo que es importante seleccionar adecuadamente la proyecci√≥n para hacer nuestros an√°lisis. En el an√°lisis de procesos de puntos el inter√©s es la densidad por unidad de √°rea, de modo que siempre tenemos que buscar una <strong>proyecci√≥n que conserve las √°reas</strong> a expensas de la representaci√≥n adecuada de los √°ngulos.</p>
<p>Las proyecciones que conservan las √°reas llevan nombres como <em>Equal area</em>, y las hay desarrolladas para regiones espec√≠ficas. Puedes visitar <a href="https://pnavarrc.github.io/workshop-d3-maps/pages/geographic-projections/">esta p√°gina</a> para ver c√≥mo las diferentes proyecciones afectan la representaci√≥n de la superficie terrestre.</p>
<p>Para ayudarnos a seleccionar el sistema de proyecci√≥n adecuado para nuestros an√°lisis, necesitamos identificar el nombre de la proyecci√≥n que necesitamos. La gran mayor√≠a de los datos geogr√°ficos disponibles est√°n en proyecci√≥n WGS84, que es una <a href="https://pnavarrc.github.io/workshop-d3-maps/img/equirectangular.png">proyecci√≥n cil√≠ndrica</a>. Existe una base de datos de proyecciones geogr√°ficas con c√≥digos de identificaci√≥n que se llaman <em>EPSG</em>. En esta biblioteca de proyecciones el c√≥digo EPSG para la proyecci√≥n WGS84 es EPSG 4326. Todas las proyecciones tienen un identificador EPSG, y est√°n desarrolladas para representar lo mejor posible las √°reas √≥ formas de regiones geogr√°ficas espec√≠ficas. Para regiones cerca del ecuador, las proyecciones cil√≠ndricas son las m√°s adecuadas, a latitudes medias las c√≥nicas y para los polos las proyecciones planares (tangentes a las superficie).</p>
<p>Las proyecciones dise√±adas para M√©xico est√°n agrupadas con el nombre ITRF2008. Para buscar los identificadores EPSG puedes dirigirte a <a href="https://epsg.io/">https://epsg.io/</a> y hacer la b√∫squeda espec√≠fica para el pa√≠s donde har√°s el an√°lisis. Una vez obtenidos los resultados, las proyecciones geogr√°ficas con √°reas iguales se pueden filtrar en el men√∫ a mano derecha bajo la liga ‚Äúprojected‚Äù.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:proyeccion"></span>
<img src="Unidad-V/proyeccion.png" alt="P√°gina de la biblioteca de EPSG, con la b√∫squeda para M√©xico." width="540" />
<p class="caption">
Figura 7.1: P√°gina de la biblioteca de EPSG, con la b√∫squeda para M√©xico.
</p>
</div>
<p>Una vez filtrada la b√∫squeda para sistemas de coordenadas proyectadas, podemos dar click en las ligas ‚ÄúGet position on a map‚Äù para identificar la regi√≥n geogr√°fica para la cual fue dise√±ado ese sistema. En el ejemplo seleccion√© el √∫ltimo elemento de la lista, que optimiza la representaci√≥n de la pen√≠nsula de Yucat√°n.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:yucatan"></span>
<img src="Unidad-V/Yucatan.png" alt="Liga para ver la regi√≥n geogr√°fica" width="318" />
<p class="caption">
Figura 7.2: Liga para ver la regi√≥n geogr√°fica
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-78"></span>
<img src="Unidad-V/epsg6371.png" alt="Regi√≥n geogr√°fica para la proyecci√≥n ITRF2008 centrada en la pen√≠nsula de Yucat√°n, con identificador EPSG n√∫mero 6371." width="621" />
<p class="caption">
Figura 7.3: Regi√≥n geogr√°fica para la proyecci√≥n ITRF2008 centrada en la pen√≠nsula de Yucat√°n, con identificador EPSG n√∫mero 6371.
</p>
</div>
<div id="transformando-los-sistemas-de-coordenadas-en-r" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Transformando los sistemas de coordenadas en R<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#transformando-los-sistemas-de-coordenadas-en-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para hacer transformaciones de coordenadas en R es necesario, primero que nada, indicarle a R cu√°l es el sistema de coordenadas de los datos a convertir. Este paso se hace al inicio del script donde comenzamos los an√°lisis de modo que todos los pasos posteriores se hagan con los datos en la proyecci√≥n correcta.</p>
<p>Como ejemplo veamos la transformaci√≥n de las capas raster que hemos estado utilizando en todos los ejemplos. Comenzaremos por preguntarle a R cu√°l es la proyecci√≥n actual:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(s)</span></code></pre></div>
<pre><code>## [1] &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<p>En este caso, no tenemos que indicar la proyecci√≥n, por lo que podemos hacer la transformaci√≥n:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb111-1" aria-hidden="true" tabindex="-1"></a>s.it08 <span class="ot">&lt;-</span> <span class="fu">projectRaster</span>(s, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:6371&quot;</span>))</span>
<span id="cb111-2"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(s.it08)</span></code></pre></div>
<p><img src="Mod-nich-distr-MPPs_files/figure-html/unnamed-chunk-81-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Para transformar los puntos necesitamos una funci√≥n distinta, y en este caso, s√≠ declarar la proyecci√≥n inicial de los puntos, despu√©s de transformarlos en un objeto espacial:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb112-1" aria-hidden="true" tabindex="-1"></a>puntos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Datos-ejemplos/Puntos-tutorial-2.csv&quot;</span>)</span>
<span id="cb112-2"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(puntos) <span class="ot">&lt;-</span> <span class="er">~</span>x<span class="sc">+</span>y</span></code></pre></div>
<p>Declaraci√≥n de la proyecci√≥n, la cual es WGS (EPSG4326):</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(puntos) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:4326&quot;</span>)</span></code></pre></div>
<p>Transformaci√≥n al nuevo sistema de coordenadas:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb114-1" aria-hidden="true" tabindex="-1"></a>puntos.it08 <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(puntos, <span class="at">CRSobj =</span> <span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:6371&quot;</span>))</span></code></pre></div>
<p>Ahora comprobamos que los puntos est√©n dentro de la ventana de trabajo:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(s.it08[[<span class="dv">1</span>]]); <span class="fu">points</span>(puntos.it08)</span></code></pre></div>
<p><img src="Mod-nich-distr-MPPs_files/figure-html/unnamed-chunk-85-1.png" width="432" /></p>
</div>
</div>
<div id="selecci√≥n-de-variables-ambientales" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Selecci√≥n de variables ambientales<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#selecci√≥n-de-variables-ambientales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para ajustar un modelo de puntos necesitamos identificar las variables ambientales que incluiremos con sus f√≥rmulas respectivas. Hasta este momento nos hemos enfocado en ajustar modelos muy sencillos con pocas variables, por lo que a√∫n nos queda por identificar una serie de variables adicionales que podr√≠an explicar la correlaci√≥n espacial de nuestros datos. El procedimiento para identificar m√°s variables ambientales es el mismo que anteriormente, pero necesitamos comenzar con un objeto del tipo <code>stack</code> que contenga m√°s variables.</p>
<p>En 2005 Robert Hijmans public√≥ la famosa base de datos <a href="https://worldclim.org">WorldClim</a>, donde desarroll√≥ un conjunto de 19 variables compuestas que denomin√≥ variables bioclim√°ticas, que representar diferentes combinaciones de temperatura y precipitaci√≥n, una en relaci√≥n a la otra. La lista completa de variables bioclim√°ticas es:</p>
<ol style="list-style-type: decimal">
<li><strong>bio1</strong> = Temperatura anual promedio</li>
<li><strong>bio2</strong> = Rango diurno de temperatura (promedio de temperatura m√°xima - m√≠nima)</li>
<li><strong>bio3</strong> = Isotermalidad (bio2/bio7) (* 100)</li>
<li><strong>bio4</strong> = Estacionalidad de la temperatura (Desviaci√≥n est√°ndad <span class="math inline">\(\times 100\)</span>)</li>
<li><strong>bio5</strong> = Temperatura m√°xima del mes m√°s c√°lido</li>
<li><strong>bio6</strong> = Temperatura m√≠numa del mes m√°s fr√≠o</li>
<li><strong>bio7</strong> = Rango anual de temperatura (bio5-bio6)</li>
<li><strong>bio8</strong> = Temperatura promedio del cuarto m√°s h√∫medo</li>
<li><strong>bio9</strong> = Temperatura promedio del cuarto m√°s seco
10 <strong>bio10</strong> = Temperatura promedio de cuarto m√°s h√∫medo</li>
<li><strong>bio11</strong> = Temperatura promedio del cuarto m√°s fr√≠o</li>
<li><strong>bio12</strong> = Precipitaci√≥n anual total</li>
<li><strong>bio13</strong> = Precipitaci√≥n del mes m√°s h√∫medo
14 <strong>bio14</strong> = Precipitaci√≥n dle mes m√°s seco</li>
<li><strong>bio15</strong> = Estacionalidad de la precipitaci√≥n (coeficiente de variaci√≥n)</li>
<li><strong>bio16</strong> = Precipitaci√≥n del cuarto m√°s h√∫medo</li>
<li><strong>bio17</strong> = Precipitaci√≥n del cuarto m√°s seco
18 <strong>bio18</strong> = Precipitaci√≥n del cuarto m√°s c√°lido</li>
</ol>
<p>Como resulta evidente agunas de estas variables bioclim√°ticas son construidas con base en otras variables bioclim√°ticas (bio3 y bio7, p.¬†ej.). Por ello, algunas de estas est√°n correlacionadas y no deben ser incluidas en el mismo modelo:</p>
<ul>
<li>bio3 es incompatible con bio2 y bio7 simult√°neamente</li>
<li>bio7 es incompatible con bio 5 y bio6 simult√°neamente</li>
</ul>
<p>Entonces el proceso de identificaci√≥n de variables tiene que tomar en cuenta esta colinealidad de facto y toda aquella que pueda ser identificada estad√≠sticamente.</p>
<p>Adem√°s de estos estas cualidades de las que debemos estar conscientes, tambi√©n es necesario tomar en cuenta que algunas de las variables bioclim√°ticas suelen tener artefactos espaciales, es decir caracter√≠sticas geogr√°ficas que no representan atributos reales de la variaci√≥n espacial del clima. Estos artefactos se presentan m√°s comunmente en las variables <strong>bio8</strong>, <strong>bio9</strong> y <strong>bio14</strong>. Entonces, antes de comenzar con la selecci√≥n de variables bioclim√°ticas, es buena pr√°ctica revisar si estas variables presentan los artefactos mencionados para el √°rea de estudio (<a href="https://besjournals.onlinelibrary.wiley.com/cms/asset/7f44bc08-b557-43cb-b798-56117c3abe79/mee313488-fig-0002-m.jpg">ejemplo</a>).</p>
<p>Para hacer la lista de variables compatibles, podemos utilizar las gr√°ficas de correlaci√≥n por pares, como se ha mostrado anteriormente. A partir de estas gr√°ficas comenzamos a hacer la lista de variables compatibles entre s√≠ con base en un coeficiente de correlaci√≥n tolerado. Como regla de dedo utilizamos el valor <span class="math inline">\(-0.7 \geq r \leq 0.7\)</span>.</p>
<p>Las listas de covariables compatibles pueden ser formuladas con el reemplazo de variables no compatibles entre s√≠. Por ejemplo, si bio1 y bio5 est√°n correlacionadas entre s√≠, pero ninguna de las dos est√° correlacionada con bio2, y bio3, las listas de variables compatibles ser√≠a:</p>
<ol style="list-style-type: decimal">
<li>bio1, bio2 y bio3</li>
<li>bio2, bio3 y bio5</li>
<li>bio1, bio2</li>
<li>bio1, bio3</li>
<li>bio2 y bio3</li>
<li>Todas las combinaciones que surjan</li>
</ol>
<p>Con base en estas listas y las gr√°ficas de intensidad de puntos en relaci√≥n a las diferentes variables podemos proponer las f√≥rmulas para los modelos basadas en los tipos de respuestas que identifiquemos.</p>
</div>
<div id="validaci√≥n-del-modelo" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Validaci√≥n del modelo<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#validaci√≥n-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La validaci√≥n es un paso esencial en el proceso del desarrollo de un modelo, pues informa al usuario de la capacidad predictiva y la magnitud de los errores esperados. En modelaci√≥n correlativa de nichos ecol√≥gicos hay pr√°cticas est√°ndar que consisten de:</p>
<ol style="list-style-type: decimal">
<li>Proponer modelo</li>
<li>Dividir presencias es datos de ajuste y de validaci√≥n</li>
<li>Medir capacidad predictiva de un modelo utilizando los datos de validaci√≥n</li>
<li>Seleccionar modelo que mejor prediga los datos de validaci√≥n</li>
</ol>
<p>La metodolog√≠a general de modelaci√≥n de nichos fue desarrollada as√≠ porque las herramientas espacialmente expl√≠citas y estad√≠sticamente robustas como los procesos de puntos no se hab√≠an adoptado en ecolog√≠a hasta hace unos 10 a√±os que se demostr√≥ que son equivalentes a metodolog√≠as de aprendizaje de m√°quinas desarrolladas espec√≠ficamente para modelar distribuciones de organismos como MaxEnt <span class="citation">(<a href="#ref-Renner2013" role="doc-biblioref">Renner and Warton 2013</a>)</span>. Con procesos de puntos, es posible proponer y seleccionar modelos con base en la larga tradici√≥n de modelaci√≥n estad√≠stica frecuentista que ya es muy bien entendida y para la cual se han desarrollado criterios claros para medir qu√© tan bien un modelo representa los datos (como el de informaci√≥n de Akaike). Sin embargo, tambi√©n se ha demostrado, que estos criterios pueden fallar cuando los datos analizados involucran correlaci√≥n espacial <span class="citation">(<a href="#ref-Velasco2019akaike" role="doc-biblioref">Velasco and Gonz√°lez-Salazar 2019</a>)</span>. Por lo tanto, es recomendable continuar aplicando algunos de los m√©todos de validaci√≥n que se comenzaron a adaptar a la modelaci√≥n de nichos ecol√≥gicos desde sus etapas tempranas.</p>
<div id="pruebas-de-validaci√≥n-estad√≠stica" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Pruebas de validaci√≥n estad√≠stica<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#pruebas-de-validaci√≥n-estad√≠stica" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="√°rea-bajo-la-curva" class="section level4 hasAnchor" number="7.3.1.1">
<h4><span class="header-section-number">7.3.1.1</span> √Årea bajo la curva<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#√°rea-bajo-la-curva" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Estas tienen como objetivo dotar al usuario de los modelos de la informaci√≥n necesaria para establecer un balance entre distintos errores de predicci√≥n. Hasta hace unos a√±os, la m√©trica de elecci√≥n era el √°rea bajo la curva del operador caracter√≠stico (AUC-ROC por sus siglas en ingl√©s). Este m√©todo pretende evaluar la capacidad de un modelo de distribuci√≥n de distinguir entre presencias de ausencias. Un modelo perfecto es aquel que clasifica correctamente todas las presencias como presencias y las ausencias como ausencias, lo que resulta en un AUC = 1. Cuando el modelo no distingue presencias de ausencias mejor que un predictor aleatorio AUC = 0.5. En un escenario ideal, lo datos de presencia y ausencia que se utilizan para calcular el AUC son datos que no te utilizaron para ajustar el modelo, por lo que la partici√≥n de la base de datos es necesaria. Esta prueba de desempe√±o predictivo, naturalmente s√≥lo es √∫til cuando se cuenta con datos de ausencia verdadera y el m√©todo de modelaci√≥n es adecuado para ese tipo de datos, y por lo tanto no es adecuada para medis el deseme√±o de modelos bsados en procesos de puntos.</p>
<p>Adem√°s de ser una prueba inadecuada para datos de s√≥lo presencia, el AUC, tiene graves deficiencias para modelaci√≥n de √°reas de distribuci√≥n. La mayor de ellas tiene que ver con el criterio espacial para asignar los puntos de ausencia, si √©stos se encuentran en regiones muy lejanas a los puntos de presencia, el modelo podr√° discriminarlas muy f√°cilmente, generando la falsa sensaci√≥n de que es muy bueno para predecir <span class="citation">(<a href="#ref-Barve2011" role="doc-biblioref">Barve et al. 2011</a>)</span> (figura <a href="#Barve-area"><strong>??</strong></a>). En este respecto, se recomienda entonces que las ausencias utilizadas provengan de regiones que sean accesibles para la especie pero no est√© presente por las condiciones ambientales que presenta. Adem√°s se han propuesto una serie de adecuaciones de simulaci√≥n para estimar valores de significancia estad√≠stica <span class="citation">(<a href="#ref-Raes2007" role="doc-biblioref">Raes and Ter Steege 2007</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Barve-area"></span>
<img src="Unidad-V/Barve-area.png" alt="Efecto el √°rea de calibraci√≥n sobre el desempe√±o predictivo medido con el √°rea bajo la curva." width="325" />
<p class="caption">
Figura 7.4: Efecto el √°rea de calibraci√≥n sobre el desempe√±o predictivo medido con el √°rea bajo la curva.
</p>
</div>
</div>
<div id="cociente-de-√°reas-parciales" class="section level4 hasAnchor" number="7.3.1.2">
<h4><span class="header-section-number">7.3.1.2</span> Cociente de √°reas parciales<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cociente-de-√°reas-parciales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Peterson <span class="citation">(<a href="#ref-Peterson2008" role="doc-biblioref">Peterson, Papes, and Soberon 2008</a>)</span> propuso una modificaci√≥n a la AUC llamada ROC parcial, para evaluar predictores espaciales, que est√°n basados en el porcentaje de predicci√≥n en relaci√≥n al tama√±o de las √°reas predichas al aumentar los umbrales de binarizaci√≥n de un modelo. La diferencia principal entre el cociente de √°reas parciales propuesto por Peterson et al.¬†(2008), est√° en los ejes utilizados para estimarla. En las AUC tradicionales, se utiliza en el eje <span class="math inline">\(x\)</span> el porcentaje de presencias predichas y en el <span class="math inline">\(y\)</span> el pocentaje de ausencias clasificadas como presencias. En las ROC parciales, el eje <span class="math inline">\(x\)</span> es el porcentaje de √°rea predicha y en el <span class="math inline">\(y\)</span> el porcentaje de presencias predichas (Figura <a href="#Peterson-parcial"><strong>??</strong></a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Peterson-parcial"></span>
<img src="Unidad-V/Peterson-parcial.png" alt="Los ejes que utilizados en la estimaci√≥n de las ROC parciales." width="2067" />
<p class="caption">
Figura 7.5: Los ejes que utilizados en la estimaci√≥n de las ROC parciales.
</p>
</div>
<p>El nombre <em>ROC parcial</em> proviene del hecho de que el valor final obtenido es el cociente del √°rea total bajo la curva entre el √°rea que indica el ubral de predicci√≥n aleatoria, que es equivalente a la proporci√≥n de √°rea predicha, eliminando posibles sesgos de estimaci√≥n producto del posible valor que indica predicci√≥n aleatoria. Por ejemplo, si un modelo s√≥lo predice 20% del √°rea como favorable para la especie, y en dicha √°rea s√≥lo se encuentra el 20% de las presencias, 20%/20% = 1, lo que indica que el modelo es un predictor netamente aleatorio. Por el contrario, si con un 20% de √°rea predicha, el modelo predice 40% de las presencias 40/20 = 2, indicando que el modelo es significativamente mejor que aleatorio.</p>
<p>El resultado es una m√©trica de evaluaci√≥n menos sensible al √°rea de calibraci√≥n que las AUC tradicionales y que es tambi√©n m√°s adecuada para evaluar la capacidad predictiva de modelos construidos s√≥lo con datos de presencia <span class="citation">(<a href="#ref-Barve2011" role="doc-biblioref">Barve et al. 2011</a>)</span>.</p>
</div>
<div id="tutorial-de-validaci√≥n" class="section level4 hasAnchor" number="7.3.1.3">
<h4><span class="header-section-number">7.3.1.3</span> Tutorial de validaci√≥n<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#tutorial-de-validaci√≥n" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vamos a analizar primero dos estrategias de partici√≥n de datos, una aleatoria y otra espacialmente estructurada. En la partici√≥n aleatoria, los puntos de ajuste y validaci√≥n se seleccionan aleatoriamente, en la espacialmente estructurada se utilizan todos los puntos de una regi√≥n para ajustar un modelo y los puntos de otras regiones para validarlo.</p>
<div id="partici√≥n-aleatoria" class="section level5 hasAnchor" number="7.3.1.3.1">
<h5><span class="header-section-number">7.3.1.3.1</span> Partici√≥n aleatoria<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#partici√≥n-aleatoria" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Comenzaremos seleccionanado aleatoriamente el 70% de los puntos para ajuste y 30% para validaci√≥n, una vez que tengamos el objeto de puntos crudo, sin formatear para spatstat:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb116-1" aria-hidden="true" tabindex="-1"></a>datos.aj <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(puntos), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(puntos)))</span>
<span id="cb116-2"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb116-2" aria-hidden="true" tabindex="-1"></a>datos.val <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(puntos))[ <span class="sc">!</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(puntos))<span class="sc">%in%</span> datos.aj ]</span>
<span id="cb116-3"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(puntos[datos.val, ], <span class="st">&quot;../Datos-ejemplos/Puntos-validacion.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb116-4"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb116-5" aria-hidden="true" tabindex="-1"></a>ppp.aj <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> puntos<span class="sc">$</span>x[datos.aj], <span class="at">y =</span> puntos<span class="sc">$</span>y[datos.aj],</span>
<span id="cb116-6"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb116-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">window =</span> w)</span></code></pre></div>
<pre><code>## Warning: 2 points were rejected as lying outside the specified window</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb118-1" aria-hidden="true" tabindex="-1"></a>ppp.val <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> puntos<span class="sc">$</span>x[datos.val], <span class="at">y =</span> puntos<span class="sc">$</span>y[datos.val],</span>
<span id="cb118-2"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb118-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">window =</span> w)</span></code></pre></div>
<p>En <code>datos.aj</code> estamos seleccionando al azar las filas para ajustar el modelo, mientras que en <code>datos.val</code>, estamos extrayendo todas las filas que no se seleccionaron para ajustar. Una vez identificados los puntos que se utilizar√°n para ajustar y validar, se utilizan los √≠ndices para crear los dos objetos que se utilizar√°n para ajustar y validar respectivamente. El procedimiento para ajustar un modelo con la base de datos de ajuste es el mismo que anteriormente. Nos saltamos la parte del diagn√≥stico pues el inter√©s ahora se centra en medir la capacidad predictiva. Una vez ajustado el modelo necesitamos guardar las predicciones en formato raster</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb119-1" aria-hidden="true" tabindex="-1"></a>m.val <span class="ot">&lt;-</span> <span class="fu">ppm</span>(<span class="at">Q =</span> ppp.aj, <span class="co"># Proceso de puntos en formato ppp</span></span>
<span id="cb119-2"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb119-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trend =</span> <span class="sc">~</span> Var<span class="fl">.2</span> <span class="sc">+</span> Var<span class="fl">.3</span> <span class="sc">+</span> <span class="fu">I</span>(Var<span class="fl">.2</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(Var<span class="fl">.3</span><span class="sc">^</span><span class="dv">2</span>), <span class="co">#  Formula del modelo seleccionado</span></span>
<span id="cb119-3"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb119-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">covariates =</span> s.im)</span>
<span id="cb119-4"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb119-4" aria-hidden="true" tabindex="-1"></a>pred.val <span class="ot">&lt;-</span> <span class="fu">predict</span>(m.val, <span class="at">dimyx =</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">30</span>), <span class="at">type =</span> <span class="st">&quot;trend&quot;</span>)</span>
<span id="cb119-5"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb119-5" aria-hidden="true" tabindex="-1"></a>pred.val.r <span class="ot">&lt;-</span> <span class="fu">raster</span>(pred.val)</span>
<span id="cb119-6"><a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(pred.val.r, <span class="st">&quot;../Datos-ejemplos/Res/Predicciones-validacion-aleat&quot;</span>, <span class="st">&quot;GTiff&quot;</span>)</span></code></pre></div>
<p>Una vez guardadas las predicciones del modelo, necesitamos instalar y cargar el paquete <code>kuenm</code> que contiene la funci√≥n para calcular las ROC parciales. La instalaci√≥n es un poco diferente pues requiere instalar el paquete <code>devtools</code> porque <code>kuenm</code> no est√° almacenado en los repositorios de <strong>R</strong>.</p>
<p>Una vez, instalado, continuamos evaluando el modelo con el cociente de √°reas del ROC:</p>
<pre><code>## Warning: `mutate_()` was deprecated in dplyr
## 0.7.0.
## ‚Ñπ Please use `mutate()` instead.
## ‚Ñπ See vignette(&#39;programming&#39;) for
##   more help
## ‚Ñπ The deprecated feature was likely
##   used in the dplyr package.
##   Please report the issue at
##   &lt;]8;;https://github.com/tidyverse/dplyr/issueshttps://github.com/tidyverse/dplyr/issues]8;;&gt;.</code></pre>
<p>para ver los resultados:</p>
<pre><code>## Mean_AUC_ratio_at_5%            pval_pROC 
##             1.031063             0.000000</code></pre>
</div>
</div>
<div id="datos-de-validaci√≥n-estructurados-espacialmente" class="section level4 hasAnchor" number="7.3.1.4">
<h4><span class="header-section-number">7.3.1.4</span> Datos de validaci√≥n estructurados espacialmente<a href="unidad-v-el-desarrollo-de-un-modelo-de-nicho-o-de-distribuci√≥n.html#datos-de-validaci√≥n-estructurados-espacialmente" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para muestrear los puntos con una estructura espacial, necesitamos dise√±ar un criterio. Una de las alternativas m√°s populares es la creaci√≥n de una cuadr√≠cula de ajedrez, y utilizar los puntos en cuadros blancos para ajustar y los puntos en cuadros negros para validar. La generaci√≥n de los cuadros est√° implementada en el paquete <code>dismo</code>, en la funci√≥n <code>gridSample</code>:</p>
<p>Como muestra del resultado:</p>
<p><img src="Mod-nich-distr-MPPs_files/figure-html/unnamed-chunk-93-1.png" width="432" style="display: block; margin: auto;" /><img src="Mod-nich-distr-MPPs_files/figure-html/unnamed-chunk-93-2.png" width="432" style="display: block; margin: auto;" /></p>
<p>A partir de este punto el proceso de validaci√≥n es el mismo que con las muestras aleatorias, aunque es preferible seguir el siguiente proceso:</p>
<ol style="list-style-type: decimal">
<li>Ajustar modelo con puntos en cuadrantes blancos y validar con puntos en cuadrantes negros</li>
<li>Ajustar modelo con puntos en cuadrantes negros y validar con puntos en cuadrantes blancos</li>
</ol>

</div>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Barve2011" class="csl-entry">
Barve, Narayani, Vijay Barve, Alberto Jim√©nez-Valverde, Andres Lira-Noriega, Sean P Maher, a. T Peterson, Jorge Sober√≥n, and Fabricio Villalobos. 2011. <span>‚ÄúThe Crucial Role of the Accessible Area in Ecological Niche Modeling and Species Distribution Modeling.‚Äù</span> <em>Ecological Modelling</em> 222 (11): 1810‚Äì19. <a href="https://doi.org/10.1016/j.ecolmodel.2011.02.011">https://doi.org/10.1016/j.ecolmodel.2011.02.011</a>.
</div>
<div id="ref-Peterson2008" class="csl-entry">
Peterson, A Townsend, Monica Papes, and Jorge Soberon. 2008. <span>‚ÄúRethinking Receiver Operating Characteristic Analysis Applications in Ecological Niche Modeling.‚Äù</span> <em>Ecological Modelling</em> 213 (1): 63‚Äì72. <a href="https://doi.org/10.1016/j.ecolmodel.2007.11.008">https://doi.org/10.1016/j.ecolmodel.2007.11.008</a>.
</div>
<div id="ref-Raes2007" class="csl-entry">
Raes, Niels, and Hans Ter Steege. 2007. <span>‚ÄúA Null-Model for Significance Testing of Presence-Only Species Distribution Models.‚Äù</span> <em>Ecography</em> 30 (5): 727‚Äì36. <a href="https://doi.org/10.1111/j.2007.0906-7590.05041.x">https://doi.org/10.1111/j.2007.0906-7590.05041.x</a>.
</div>
<div id="ref-Renner2013" class="csl-entry">
Renner, Ian W, and David I Warton. 2013. <span>‚ÄúEquivalence of <span>MAXENT</span> and <span>Poisson</span> Point Process Models for Species Distribution Modeling in Ecology.‚Äù</span> <em>Biometrics</em> 69 (1): 274‚Äì81. <a href="https://doi.org/10.1111/j.1541-0420.2012.01824.x">https://doi.org/10.1111/j.1541-0420.2012.01824.x</a>.
</div>
<div id="ref-Velasco2019akaike" class="csl-entry">
Velasco, Juli√°n A, and Constantino Gonz√°lez-Salazar. 2019. <span>‚ÄúAkaike Information Criterion Should Not Be a <span>‚ÄòTest‚Äô</span> of Geographical Prediction Accuracy in Ecological Niche Modelling.‚Äù</span> <em>Ecological Informatics</em> 51: 25‚Äì32.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="unidad-iv-modelos-para-procesos-de-puntos-con-estructura-espacial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Mod-nich-distr-MPPs.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
